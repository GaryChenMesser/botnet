import csv
import matplotlib.pyplot as plt

with open('../botnet_test/capture20110818-2.binetflow', newline='') as f:
	data = list(csv.reader(f))

bot = []
back_ground = []
for i, line in enumerate(data):
	if line[-1].find('Botnet') != -1:
		bot.append(i)
	if line[-1].find('Background') != -1:
		back_ground.append(i)

print(len(bot))
print(bot[-1])
print(len(back_ground))
print(back_ground[-1])

#for i in bot:
#	plt.axvline(x=i)

plt.plot([2.040816327, 2.003325021, 2.005882353, 1.982905983, 2.00472255, 1.982869379, 1.947984395, 1.988571429, 1.981958763, 1.984496124, 2.003139717, 1.96101949, 1.941284404, 1.949640288, 1.987075929, 1.969135802, 1.898305085, 1.944444444, 2.005270092, 1.972560976, 1.960923623, 1.924006908, 1.983425414, 1.961077844, 1.962750716, 1.949579832, 1.929648241, 1.954372624, 1.93902439, 1.959302326, 1.959119497, 1.977142857, 1.947826087, 1.98757764, 1.934595525, 1.939849624, 1.934664247, 1.996336996, 1.946768061, 1.923224568, 1.947474747, 1.944, 1.958174905, 1.955403087, 1.961904762, 1.945750452, 1.9744, 1.97979798, 1.953216374, 1.952380952, 1.958071279, 1.973929236, 2.037037037, 1.960992908, 1.9527897, 1.97037037, 1.936567164, 1.905923345, 1.937608319, 1.936883629, 1.945736434, 1.968944099, 1.934664247, 1.957281553, 1.926977688, 1.930735931, 1.925601751, 1.948, 1.925465839, 1.986666667, 2.038709677, 1.909836066, 2, 1.952662722, 1.936090226, 1.972166998, 1.977952756, 1.94686907, 1.947046843, 1.9453125, 1.963488844, 1.968441815, 1.958518519, 1.966850829, 1.927007299, 1.930864198, 1.88045977, 1.896713615, 1.958715596, 1.93877551, 1.960854093, 1.950790861, 1.965116279, 1.991011236, 1.958412098, 1.996884735, 1.967213115, 1.961977186, 1.968804159, 1.951434879])

plt.xlabel('second')
plt.ylabel('divergence')
#axe = plt.gca()
#axe.axes.set_xlim([0,back_ground[-1]])
#plt.gca().axes.get_yaxis().set_ticks([])
#axe.axes.get_yaxis().set_visible(False)

plt.savefig('divergence.png')
plt.show()
'''
with open('../botnet_test/botOnly20110819.binetflow', 'w') as f:
	w = csv.writer(f)
	for i in bot:
		w.writerow(data[i])

with open('../botnet_test/backOnly20110819.binetflow', 'w') as f:
	w = csv.writer(f)
	for i in back_ground:
		w.writerow(data[i])
'''
