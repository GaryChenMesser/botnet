import csv
import matplotlib.pyplot as plt

with open('../botnet_test/capture20110819.binetflow', newline='') as f:
	data = list(csv.reader(f))

bot = []
back_ground = []
for i, line in enumerate(data):
	if line[-1].find('Botnet') != -1:
		bot.append(i)
	if line[-1].find('Background') != -1:
		back_ground.append(i)

print(len(bot))
print(len(back_ground))

#for i in bot:
#	plt.axvline(x=i)
plt.plot([ -0.03981187992, -0.04719037331
, -0.09851394281, -0.02854099771, -0.02648303624, -0.02996240467, 0.0172558269, 0.01247836694, 0.02174964337, 0.01547472486, 0.1337091286, -0.001556435238, 0.02601891734, -0.02980516825, -0.01759648894, 0.05680151679, 0.04405173736, 0.004386705974, 0.02030999683, 0.07872346324, -0.009699778157, 0.1320116541, 0.046794034, 0.09942005019, -0.05124187639, 0.001723918551, -0.001384560217, 0.03278130323, 0.1806844046, 0.03559278236, 0.0757239474, 0.1307059854, 0.04019748383, 0.002402512835, -0.002260131153, 0.0254673613, -0.05549185576, 0.01793391796, 0.06365332232, 0.009844959451, 0.0950975967, 0.0457191474, -0.01128964147, 0.02695713659, 0.06711713872, -0.01203030234, 0.05976217691, -0.04287729644, 0.001522922523, 0.0409300807, 0.08705113249, 0.01266325196, 0.006080452696, 0.08408937348, 0.04490783911, 0.07435149054, -0.01991606244, 0.07068510734, 0.05141160404, 0.1068223839, 0.01638157913, 0.1298885766, 0.2214169929, 0.1124525908, 0.007952388795, 0.106861141, -0.003985429367, 0.08937765342, 0.2227993513, 0.03585077862, 0.0246723406, 0.08659733842, 0.001783177746, -0.02093886647, -0.02971471175, 0.04993723036, 0.01987343433, -0.008864635894, 0.09076380333, 0.006265473078, 0.1391942411, 0.00047778841, 0.04939508283, -0.0467971839, 0.1461788449, 0.1152019944, 0.07572908395, -0.01510005341, 0.04752086825, 0.05467078508, -0.02652243543, 0.09303983352, 0.02575595246, 0.1318515604, -0.04910110112, -0.03446396731, 0.002849167075, 0.03987833692, 0.1624427059, 0.01144003045, 0.109930735, 0.06221715913, -0.00210990355, 0.120123571, -0.02196338423, 0.269053923, -0.01867494252, -0.008439300891, -0.04402731607, -0.02695164268, 0.04076998816, 0.05919175762, -0.04318971696, -0.07776844022, 0.006672506119, -0.03196826789, 0.04198775469, -0.001835438182, 0.03401977979, 0.06882970046, -0.01478946911, 0.1586619139, -0.04293702087, 0.09595415969, -0.001592410663, 0.0625529436, -0.05151565534, -0.03261695229, 0.0255445169, 0.006808459999, 0.05944967285, 0.04581996659, 0.05556149251, 0.04201037768, -0.01878422984, 0.05516814425, 0.01384409352, -0.06675292199, 0.267620442, 0.05294273611, 0.08388225334, -0.0625122116, 0.04943396911, -0.005363016998, -0.05422252481, 0.02787287516, 0.2014985093, 0.2518259278, 0.01291155833, -0.006771453254, 0.1473666422, 0.02080509785, 0.09794491464, -0.001183273714, 0.05342956979, 0.0473933886, 0.03179093827, 0.05571977166, -0.04132519919, 0.07224614391, 0.04455151159, 0.1019163592, -0.02137997436, 0.03949186617, 0.1149475207, -0.01482256069, 0.233122991, 0.2738280857, -0.02741309012, 0.2829859595, 0.2502649825, 0.0005905228247, 0.00319504098, 0.007434104575, -0.03233984476, -0.0261191092, -0.06195841409, 0.02616979856, 0.04024743004, 0.1556039313, -0.0001439882938, -0.01574076312, -0.02546248125, 0.03032269374, 0.1612946428, 0.002363805745, -0.1098335677, -0.03146812179, -0.0652105236, -0.03520623818, -0.01955181757, 0.05430548705, 0.05576229959, 0.0233977313, 0.1068598957, 0.04257496408, 0.05674298827, -0.001462295449, -0.08773417582, 0.2415339629, -0.1003195015, 0.07931839867, -0.003672172159, 0.1044233927, -0.01736632426, -0.05068348795, -0.02727474124, -0.02741925088, -0.0509546682, -0.03390640982, -0.1574704771, -0.06479973101, -0.05721241303, -0.09452209356, 0.2365241562, 0.05255220993, -0.04558171402, -0.004206086836, -0.09876770984, -0.02032486234, 0.2726801007, -0.05977359629, -0.08972610056, 0.2560482315, 0.08538470797, 0.05280933349, 0.09814771366, 0.02805963121, 0.02290929044, -0.07386784523, -0.0006269657713, -0.001922788311, -0.002826942663, 0.1084829028, 0.07341174152, -0.002583759321, 0.1816179403, 0.301492411, 0.3059321171, 0.01150362374, 0.2685023324, -0.08444900765, 0.2572716195, -0.04129935388, -0.02741417732, 0.2047486723, -0.112443247, -0.08957086957, 0.01431580793, 0.01100498652, -0.01383246617, 0.05049079783, 0.01457468191, -0.1132081871, 0.01104614221, -0.03784079536, 0.04274361037, 0.0242270927, 0.4114037271, 0.07957952079, 0.1211579543, -0.02978963444, 0.04036462472, -0.04394194121, -0.1001264702, 0.04158907603, -0.01650792046, 0.08076254464, 0.1305203986, -0.004328992611, -0.01537946405, 0.04341101622, -0.02589672381, -0.04039438185, 0.02289117657, 0.03457880087, -0.004291334729, -0.002519499065, 0.01731407772, -0.07544136704, -0.03153861026, 0.3017742686, 0.002521499252, 0.01313473978, 0.04389314406, 0.01646427857, -0.01336268915, 0.06198933085, 0.05874857951, -0.02694244696, -0.06747582104, -0.06546534386, -0.1787545322, -0.03396336409, -0.0167674403, 0.0255093069, -0.01511524043, -0.003795298409, -0.03215283887, -0.04034349195, 0.05441454242, 0.1079256323, 0.07075263412, 0.3287996481, 0.03316686811, 0.07079999749, -0.01209767474, 0.03056752473, -0.09409746798, 0.2646145086, -0.06018281088, -0.02276979527, -0.09417037626, -0.04027972818, -0.03632250398, -0.01519457338, -0.02789078152, -0.001874782972, 0.08623851426, 0.08325011917, -0.04292786147, -0.001697326388, -0.02804910922, -0.09326323207, 0.04798505331, -0.03289162827, 0.1608777146, 0.0729266363, 0.01340703726, 0.2950898434, 0.02621834019, 0.05673963256, -0.03080191731, 0.07689925562, -0.0681912499, 0.1591560938, -0.01685723774, 0.01087063901, 0.04225263983, 0.03225025858, 0.08156758543, 0.02829953223, -0.01346586397, -0.02385787081, 0.008009591715, 0.0119113152, 0.01638135517, 0.02645917306, -0.06240998794, -0.01732967344, -0.01854434541, -0.04081398283, 0.1820616755, 0.02966433686, 0.0843790742, 0.02456073757, -0.03277124758])
plt.show()
'''
with open('../botnet_test/botOnly20110819.binetflow', 'w') as f:
	w = csv.writer(f)
	for i in bot:
		w.writerow(data[i])

with open('../botnet_test/backOnly20110819.binetflow', 'w') as f:
	w = csv.writer(f)
	for i in back_ground:
		w.writerow(data[i])
'''
